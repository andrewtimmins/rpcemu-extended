/* h.EYStructs */
//  This program is free software; you can redistribute it and/or modify it 
//  under the terms of version 2 of the GNU General Public License as 
//  published by the Free Software Foundation;
//
//  This program is distributed in the hope that it will be useful, but WITHOUT 
//  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or 
//  FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for 
//  more details.
//
//  You should have received a copy of the GNU General Public License along with
//  this program; if not, write to the Free Software Foundation, Inc., 59 
//  Temple Place - Suite 330, Boston, MA  02111-1307, USA.
//  
//  The full GNU General Public License is included in this distribution in the
//  file called LICENSE.
//
//  The code in this file is (C) 2003 J Ballance as far as
//  the above GPL permits

#include "dcistructs.h"
#include "mbuf_c.h"

/// Claimed frame type
typedef struct ClaimBuf ClaimBuf;
struct ClaimBuf {
	// Filter
	int		flags;		///< non-zero if ensure_safe needed on mbuf
	int		unit;		///< unit this refers to
	int		frame_type;	///< frame type
	int		frame_level;	///< frame class/level 1-4
	int		address_level;	///< address filtering level 0-3
	int		error_level;	///< error level

	// For calling the Protocol module
	int		handler;	///< Address of Protocol module's received frame handler
	void		*pwp;		///< Protocol module's private workspace pointer

	// List pointers
	ClaimBuf	*next;		///< pointer to next in list, or NULL if end
	ClaimBuf	*prev;		///< pointer to previous in list, or NULL if start
};

// workspace pointer.. holds allsorts..
// first 3 (or 4 with the test area) entries MUST be there in that sequence.
// structure holds pointer to any area passed to IRQ
typedef struct {
	void		*pwp;		///< Module's PWP for C routine linkage
	dci4_mbctl	*mbctl;		///< mbuf manager linkage
	Dib		base_dib;	///< device info block
	unsigned char	dev_addr[6];	///< Ethernet hardware address
	int		flags;
	ClaimBuf	*claims;	///< linked list of all claims.

	// Working copy of network statistics
	unsigned long	st_tx_frames;
	unsigned long	st_unwanted_frames;
	unsigned long	st_rx_frames;
} workspace;


